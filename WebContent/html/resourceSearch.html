<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="../layui/css/layui.css">
<link rel="stylesheet" href="../css/resourceSearch.css">
</head>
<body style="display: none;">
	<!-- 动画搜索条件        播出时间 存储地址 季度 连载时长 资源类型 格式 分辨率 字幕类型 资源名 -->
	<!-- 番剧检索条件        播出时间 存储地址 国别 季度 格式 分辨率 资源名 -->
	<!-- 电影搜索条件        上映时间 存储地址 国别 格式 分辨率 资源名  -->
	<!-- 记录片搜索条件     播出时间 存储地址 国别 格式 分辨率 资源名  -->
	<!-- 网络视频搜索条件 播出时间 存储地址 格式 分辨率 资源名 -->
	<div>
		<form class="layui-form layui-form-pane" id="searchVideo" method="post" enctype="multipart/form-data" action="">
			<div class="search-item">
				<div class="layui-inline" id="video_type_item">
					<div class="video-type-tab video-type-tab-this" onclick="clickVideoTypeButton(this)" id="动画">动画</div>
					<div class="video-type-tab " onclick="clickVideoTypeButton(this)" id="番剧">番剧</div>
					<div class="video-type-tab " onclick="clickVideoTypeButton(this)" id="电影">电影</div>
					<div class="video-type-tab " onclick="clickVideoTypeButton(this)" id="记录片">记录片</div>
					<div class="video-type-tab " onclick="clickVideoTypeButton(this)" id="网络视频">网络视频</div>
					<!--  -->
					<input type="hidden" id="videoType" name="videoType" value="动画">
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline" id="yearRangeDiv">
					<label class="layui-form-label">播出时间</label>
					<div class="layui-input-inline" style="width: 120px;">
						<input name="yearRange" id="yearRange" autocomplete="off" readonly="readonly" class="layui-input" type="text">
					</div>
				</div>
				<div class="layui-inline" id="addressDiv">
					<label class="layui-form-label">存储地址</label>
					<div class="layui-input-inline">
						<select name="address" id="address">
							<option value="ALL">全部</option>
						</select>
					</div>
				</div>
				<div class="layui-inline" id="animationSeasonDiv">
					<label class="layui-form-label">播出季</label>
					<div class="layui-input-inline" style="width: 120px;">
						<select name="animationSeason" id="animationSeason" style="width: 200px;">
							<option value="ALL">全部</option>
							<option value="冬番">冬番</option>
							<option value="春番">春番</option>
							<option value="夏番">夏番</option>
							<option value="秋番">秋番</option>
							<option value="OVA/OAD">OVA/OAD</option>
							<option value="映画">映画</option>
							<option value="其他">其他</option>
						</select>
					</div>
				</div>
				<div class="layui-inline" id="videoCountryDiv" style="display: none;">
					<label class="layui-form-label">国别</label>
					<div class="layui-input-inline" style="width: 120px;">
						<select name="country" id="country" style="width: 200px;">
							<option value="ALL">全部</option>
							<option value="日本">日本</option>
							<option value="美国">美国</option>
							<option value="英国">英国</option>
						</select>
					</div>
				</div>
				<div class="layui-inline" id="dramaSeasonDiv" style="display: none;">
					<label class="layui-form-label">播出季</label>
					<div class="layui-input-inline" style="width: 120px;">
						<select name="dramaSeason" id="dramaSeason" style="width: 200px;">
							<option value="ALL">全部</option>
							<option value="冬季">冬季</option>
							<option value="春季">春季</option>
							<option value="夏季">夏季</option>
							<option value="秋季">秋季</option>
							<option value="SP">SP</option>
						</select>
					</div>
				</div>
				<div class="layui-inline" id="serializeTimeDiv">
					<label class="layui-form-label">连载时长</label>
					<div class="layui-input-inline" style="width: 120px;">
						<select name="serializeTime" id="serializeTime">
							<option value="ALL">全部</option>
							<option value="1">季番</option>
							<option value="2">半年番</option>
							<option value="3">年番</option>
							<option value="4">长连载</option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">收录信息</label>
				<div class="layui-inline" id="typeDiv">
					<div class="layui-input-inline">
						<select name="resourceType" id="resourceType">
							<option value="ALL">全部资源</option>
							<option value="NORMAL">普通资源</option>
							<option value="BD">BD资源</option>
						</select>
					</div>
				</div>
				<div class="layui-inline" id="formatDiv">
					<div class="layui-input-inline">
						<select name="format" id="format">
							<option value="ALL">全部格式</option>
							<option value="MP4">MP4</option>
							<option value="MKV">MKV</option>
							<option value="RMVB">RMVB</option>
							<option value="AVI">AVI</option>
							<option value="WMV">WMV</option>
							<option value="其他">其他</option>
						</select>
					</div>
				</div>
				<div class="layui-inline" id="resolutionDiv">
					<div class="layui-input-inline">
						<select name="resolution" id="resolution">
							<option value="ALL">全部分辨率</option>
							<option value="1280*720">1280*720</option>
							<option value="1920*1080">1920*1080</option>
							<option value="1440*1080">1440*1080</option>
							<option value="848*480">848*480</option>
							<option value="1024*576">1024*576</option>
							<option value="960*576">960*576</option>
							<option value="3840*2160">3840*2160</option>
						</select>
					</div>
				</div>
				<div class="layui-inline" id="subTypeDiv">
					<div class="layui-input-inline">
						<select name="subType" id="subType">
							<option value="ALL">全部字幕类型</option>
							<option value="内嵌">内嵌</option>
							<option value="封装">封装</option>
							<option value="外挂">外挂</option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline" id="videoNameDiv">
					<label class="layui-form-label">资源名</label>
					<div class="layui-input-block" style="width: 576px;">
						<input name="videoName" id="videoName" autocomplete="off" class="layui-input" type="text">
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-btn layui-btn-normal" onclick="search()">搜索</div>
					<div class="layui-btn layui-btn-normal" onclick="reset()">重置</div>
					<div class="layui-btn" onclick="excelDownload()">下载列表</div>
				</div>
			</div>
		</form>
		<form id="searchVideoHide">
			<!--  -->
			<input type="hidden" id="videoNameHide" name="videoName">
			<!--  -->
			<input type="hidden" id="subTypeHide" name="subType">
			<!--  -->
			<input type="hidden" id="resolutionHide" name="resolution">
			<!--  -->
			<input type="hidden" id="formatHide" name="format">
			<!--  -->
			<input type="hidden" id="resourceTypeHide" name="resourceType">
			<!--  -->
			<input type="hidden" id="serializeTimeHide" name="serializeTime">
			<!--  -->
			<input type="hidden" id="dramaSeasonHide" name="dramaSeason">
			<!--  -->
			<input type="hidden" id="countryHide" name="country">
			<!--  -->
			<input type="hidden" id="animationSeasonHide" name="animationSeason">
			<!--  -->
			<input type="hidden" id="addressHide" name="address">
			<!--  -->
			<input type="hidden" id="yearRangeHide" name="yearRange">
			<!--  -->
			<input type="hidden" id="videoTypeHide" name="videoType" value="动画">
		</form>
	</div>
	<div id="video_list_div" class="video-list-div"></div>

	<div id="video-modile" style="display: none;">
		<div class="video-box" style="display: inline;" id="{id}">
			<div class="video-poster" id="video-poster-{id}"></div>
			<div id="video-poster-hide-{id}" style="display: none;"></div>
			<div class="video-name" onclick="detail('{id}')">{name}</div>
			<div class="video-date">{date}</div>
			<div style="float: right; width: 40px; margin: 3px 0px 3px 3px;">
				<div class="edit-div layui-btn layui-btn-xs layui-btn-normal" style="width: 40px;">
					<i class="layui-icon" style="margin-right: 0px;">&#xe65f;</i>
				</div>
				<div class="edit-list" id="edit-list-{id}" style="display: none; padding: 5px;">
					<div style="margin: 5px auto; width: 100%;" class="layui-btn layui-btn-sm layui-btn-normal" onclick="editVideo(this,'{id}')">
						<i class="layui-icon">&#xe642;</i>编辑
					</div>
					<div style="margin: 5px auto; width: 100%;" class="layui-btn layui-btn-sm layui-btn-danger" onclick="deleteVideo(this,'{id}','{name}')">
						<i class="layui-icon">&#xe640;</i>删除
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
<script src="../js/jquery-2.1.4.js"></script>
<script src="../js/jquery.serializejson.js"></script>
<script src="../layui/layui.js"></script>
<script src="../js/resourceSearch.js"></script>
<script src="../js/util.js"></script>
<script src="../js/imgController.js"></script>
<script>
	$(function() {
		setSearchCondition(300);
		loadDiskInfo();
		//初始化 年范围选择
		var range = (new Date().getFullYear() - 6) + ' - ' + new Date().getFullYear();
		$("#yearRange").val(range);
	});

	var form;
	var laydate;
	var util;
	var layer;

	layui.use([ 'form', 'laydate', 'util' ], function() {
		form = layui.form;
		laydate = layui.laydate;
		util = layui.util;
		layer = layui.layer;

		form.render('select');

		//执行
		util.fixbar({
			showHeight : "100"
		});

		laydate.render({
			elem : '#yearRange',
			type : 'year',
			/*value : range, */
			theme : '#5FB878',
			range : true
		});

		layer.ready(function() {
			$("body").show();
		});
	});

	function loadDiskInfo() {
		//加载收录地址硬盘信息
		var url = "/videoRecord/getDiskListByVideoType";
		var method = "POST";
		var data = {
			video_type : "ALL"
		};
		$.ajax({
			url : url,
			method : method,
			data : data,
			dataType : "json",
			success : function(resp) {
				if (resp.code == 0) {
					setDiskSelect(resp);
				} else {
					parent.layer.alert(resp.msg, {
						offset : "200px",
						title : "读取硬盘信息异常"
					});
				}
			},
			error : function(xhr) {
				parent.layer.alert(resp.msg, {
					offset : "200px",
					title : "读取硬盘信息异常"
				});
			}
		});
	}

	function setDiskSelect(resp) {
		var objSelect = $("#address");
		for (var i = 0; i < resp.data.length; i++) {
			objSelect.append("<option value=" + resp.data[i].disk_id + ">" + resp.data[i].disk_name + "</option>");
		}
	}

	function setSearchCondition(second) {
		var videoType = $("#videoType").val();
		switch (videoType) {
		case "动画":
			$("#videoCountryDiv").hide();
			$("#dramaSeasonDiv").hide();

			$("#animationSeasonDiv").fadeIn(second);
			$("#serializeTimeDiv").fadeIn(second);
			$("#typeDiv").fadeIn(second);
			$("#subTypeDiv").fadeIn(second);
			break;
		case "番剧":
			$("#animationSeasonDiv").hide();
			$("#serializeTimeDiv").hide();
			$("#typeDiv").hide();
			$("#subTypeDiv").hide();

			$("#videoCountryDiv").fadeIn(second);
			$("#dramaSeasonDiv").fadeIn(second);
			break;
		case "电影":
			$("#animationSeasonDiv").hide();
			$("#serializeTimeDiv").hide();
			$("#typeDiv").hide();
			$("#subTypeDiv").hide();
			$("#dramaSeasonDiv").hide();

			$("#videoCountryDiv").fadeIn(second);
			break;
		case "记录片":
			$("#animationSeasonDiv").hide();
			$("#serializeTimeDiv").hide();
			$("#typeDiv").hide();
			$("#subTypeDiv").hide();
			$("#dramaSeasonDiv").hide();

			$("#videoCountryDiv").fadeIn(second);
			break;
		case "网络视频":
			$("#animationSeasonDiv").hide();
			$("#serializeTimeDiv").hide();
			$("#typeDiv").hide();
			$("#subTypeDiv").hide();
			$("#dramaSeasonDiv").hide();
			$("#videoCountryDiv").hide();
			break;
		}
	}

	//点击空白处隐藏弹出层，下面为滑动消失效果和淡出消失效果。
	$(document).click(function(event) {
		var _con = $(".edit-list"); // 设置目标区域
		if (!_con.is(event.target) && _con.has(event.target).length === 0) { // Mark 1
			$(".edit-list").slideUp(200); //滑动消失 
		}
	});
</script>
</html>