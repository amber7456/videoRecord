<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body>
	<div style="padding: 15px 15px 0px 15px; width: 645px;">
		<form class="layui-form layui-form-pane" action="" lay-filter="diskAdd"
			id="diskAdd">
			<div class="layui-form-item">
				<label class="layui-form-label">硬盘名</label>
				<div class="layui-input-block">
					<input name="disk_name" lay-verify="disk_name" id="disk_name"
						autocomplete="off" class="layui-input" type="text">
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">硬盘容量</label>
					<div class="layui-input-inline">
						<select name="disk_capacity" id="disk_capacity"
							lay-filter="disk_capacity">
							<option value="500G">500G</option>
							<option value="1T">1T</option>
							<option value="2T" selected="selected">2T</option>
							<option value="3T">3T</option>
							<option value="4T">4T</option>
							<option value="6T">6T</option>
							<option value="8T">8T</option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">存储状态</label>
					<div class="layui-input-inline">
						<select name="is_full" id="is_full" lay-filter="is_full">
							<option value="未满">未满</option>
							<option value="已满">已满</option>
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">硬盘状态</label>
					<div class="layui-input-inline">
						<select name="disk_state" id="disk_state" lay-filter="disk_state">
							<option value="现役">现役</option>
							<option value="退役">退役</option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-inline">
					<label class="layui-form-label">创建时间</label>
					<div class="layui-input-inline">
						<input name="create_time" autocomplete="off" id="create_time"
							readonly="readonly" class="layui-input" type="text">
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">存储类型</label>
					<div class="layui-input-inline">
						<select name="video_type" id="video_type" lay-filter="video_type">
							<option value="动画" selected="selected">动画</option>
							<option value="电影">电影</option>
							<option value="剧">剧</option>
							<option value="纪录片">纪录片</option>
							<option value="网络视频">网络视频</option>
						</select>
					</div>
				</div>
			</div>
			<div class="layui-form-item layui-form-text">
				<label class="layui-form-label">备注</label>
				<div class="layui-input-block">
					<textarea id="remark" name="remark" class="layui-textarea"
						style="resize: none;"></textarea>
				</div>
			</div>
			<div class="layui-form-item">
				<div style="float: right;" class="layui-btn layui-btn-normal"
					lay-submit="" lay-filter="submitButton">提交</div>
			</div>

		</form>
	</div>
</body>
<script>
	console.log("加载硬盘添加页");

	layui.use([ 'element', 'form', 'layedit', 'laydate' ], function() {
		var element = layui.element;
		var form = layui.form;

		var layedit = layui.layedit;
		var laydate = layui.laydate;
		form.render(); //刷新 

		//日期
		laydate.render({
			elem : '#create_time',
			type : 'date',
			format : 'yyyy-MM-dd',
			value : new Date()
		});

		//创建一个编辑器
		var editIndex = layedit.build('LAY_demo_editor');

		//自定义验证规则
		form.verify({
			disk_name : function(value) {
				if (value.length <= 0) {
					return '请输入硬盘名';
				}
			}
		});

		//监听提交
		form.on('submit(submitButton)', function(data) {
			var loadIndex = top.layer.load(1);
			console.log(JSON.stringify(data.field));
			$.ajax({
				url : "/videoRecord/diskAdd/",
				method : "POST",
				contentType : 'application/json',
				data : JSON.stringify(data.field),
				dataType : "json",
				success : function(resp) {
					console.log(resp);
					top.layer.close(loadIndex);
					if (resp.code == 0) {
						if (resp.data == 1) {
							top.layer.alert("添加成功！！！", {
								offset : '200px'
							}, function(index) {
								top.layer.close(index);
								$('#diskAdd')[0].reset();
								$('#create_time').val(
										dateFtt("yyyy-MM-dd", new Date()));
							});
						} else {
							top.layer.alert("添加失败，请核对数据！！！", {
								title : '添加失败',
								offset : '200px'
							});
						}
					} else {
						top.layer.alert(resp.msg, {
							title : '程序异常',
							offset : '200px'
						})
					}
				},
				error : function(xhr) {
					top.layer.close(loadIndex);
					top.layer.alert(xhr.status + " " + xhr.statusText, {
						title : '系统异常',
						offset : '200px'
					})
				}
			});
			return false;
		});

	});

	/**************************************时间格式化处理************************************/
	function dateFtt(fmt, date) { //author: meizz   
		var o = {
			"M+" : date.getMonth() + 1, //月份   
			"d+" : date.getDate(), //日   
			"h+" : date.getHours(), //小时   
			"m+" : date.getMinutes(), //分   
			"s+" : date.getSeconds(), //秒   
			"q+" : Math.floor((date.getMonth() + 3) / 3), //季度   
			"S" : date.getMilliseconds()
		//毫秒   
		};
		if (/(y+)/.test(fmt))
			fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "")
					.substr(4 - RegExp.$1.length));
		for ( var k in o)
			if (new RegExp("(" + k + ")").test(fmt))
				fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k])
						: (("00" + o[k]).substr(("" + o[k]).length)));
		return fmt;
	}
</script>
</html>