<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>硬盘管理</title>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
</head>
<body>
	<div style="padding: 15px 15px 0px 15px;">
		<div class="layui-form-item layui-form-pane" style="width: 1100px;">
			<form class="layui-form" id="formDemo">
				<div class="layui-inline">
					<label class="layui-form-label">硬盘名</label>
					<div class="layui-input-inline">
						<input class="layui-input" name="disk_name" id="disk_name"
							autocomplete="off">
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">存储类型</label>
					<div class="layui-input-inline">
						<select name="video_type" id="video_type" lay-filter="video_type">
							<option value="ALL">全部</option>
							<option value="动画">动画</option>
							<option value="电影">电影</option>
							<option value="剧">剧</option>
							<option value="纪录片">纪录片</option>
							<option value="网络视频">网络视频</option>
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">硬盘容量</label>
					<div class="layui-input-inline">
						<select name="disk_capacity" id="disk_capacity"
							lay-filter="disk_capacity">
							<option value="ALL">全部</option>
							<option value="500G">500G</option>
							<option value="1T">1T</option>
							<option value="2T">2T</option>
							<option value="3T">3T</option>
							<option value="4T">4T</option>
							<option value="6T">6T</option>
							<option value="8T">8T</option>
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">存储状态</label>
					<div class="layui-input-inline">
						<select name="is_full" id="is_full" lay-filter="is_full">
							<option value="ALL">全部</option>
							<option value="未满">未满</option>
							<option value="已满">已满</option>
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<label class="layui-form-label">硬盘状态</label>
					<div class="layui-input-inline">
						<select name="disk_state" id="disk_state" lay-filter="disk_state">
							<option value="ALL">全部</option>
							<option value="现役">现役</option>
							<option value="退役">退役</option>
						</select>
					</div>
				</div>
				<div class="layui-inline">
					<div class="layui-btn layui-btn-normal" onclick="search()">搜索</div>
				</div>
			</form>
		</div>
		<!--  -->

		<table class="layui-hide" id="disk_table" lay-filter="disk"></table>

		<div id="barDemo" style="display: none;">
			<a class="layui-btn layui-btn-primary layui-btn-xs"
				lay-event="detail">查看</a>
			<!--  -->
			<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
			<!--  -->
			<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
		</div>
	</div>
</body>
<script type="text/javascript">
	console.log("加载硬盘列表页");
	var tableIns;
	layui.use([ 'element', 'form', 'table', 'layedit', 'laydate' ], function() {
		var element = layui.element;
		var form = layui.form;
		var table = layui.table;
		var layedit = layui.layedit;
		var laydate = layui.laydate;
		form.render(); //刷新 

		//第一个实例
		tableIns = table.render({
			elem : '#disk_table',
			url : '/videoRecord/getDiskList',
			method : 'post',
			page : {
				theme : '#1E9FFF'
			}, //开启分页
			width : 1100,
			cols : [ [ {
				field : 'disk_id',
				width : 170,
				title : '硬盘ID',
				sort : true
			}, {
				field : 'disk_name',
				title : '硬盘名'
			}, {
				field : 'video_type',
				width : 100,
				title : '存储类型'
			}, {
				field : 'disk_capacity',
				width : 100,
				title : '硬盘容量'
			}, {
				field : 'disk_state',
				width : 100,
				title : '硬盘状态'
			}, {
				field : 'is_full',
				width : 100,
				title : '容量状态'
			}, {
				field : 'create_time',
				width : 110,
				title : '创建时间'
			}, {
				field : 'remark',
				width : 100,
				title : '备注'
			}, {
				//fixed : 'right',
				title : '操作',
				width : 178,
				align : 'center',
				toolbar : '#barDemo'
			} ] ],
			id : 'diskList',
			done : function(res, curr, count) {
				//如果是异步请求数据方式，res即为你接口返回的信息。
				//如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
				//console.log(res);
				//得到当前页码
				//console.log(curr);
				//得到数据总量
				//console.log(count);
			}
		});

		//监听工具条
		table.on('tool(disk)', function(obj) {
			var data = obj.data;
			if (obj.event === 'detail') {
				top.layer.open({
					type : 2,
					title : '硬盘详情',
					offset : '200px',
					shadeClose : true,
					shade : 0.8,
					area : [ '848px', '480px' ],
					content : 'htmls/disk/diskDetail.html?disk_id='
							+ data.disk_id + "&t="
							+ (new Date()).getTime().toString() //iframe的url
				});
			} else if (obj.event === 'del') {
				top.layer.confirm('确认删除？', function(index) {
					//obj.del();
					layer.close(index);
					// 起遮罩层
					var loadIndex = layer.load(1);
					console.log(loadIndex);
					diskDel(data.disk_id, loadIndex);
				});
			} else if (obj.event === 'edit') {
				top.layer.open({
					type : 2,
					title : '硬盘信息编辑',
					offset : '200px',
					shadeClose : true,
					shade : 0.8,
					area : [ '848px', '492px' ],
					content : 'htmls/disk/diskEdit.html?disk_id='
							+ data.disk_id + "&t="
							+ (new Date()).getTime().toString() //iframe的url
				});
			}
		});

	});

	function search() {
		console.log($('#formDemo').serializeJSON());
		//console.log(JSON.stringify($('#formDemo').serializeJSON())); 
		tableIns.reload({
			where : $('#formDemo').serializeJSON(),
			page : {
				curr : 1,/* 重新从第 1 页开始 */
				theme : '#1E9FFF'
			}
		});
	}
</script>
</html>